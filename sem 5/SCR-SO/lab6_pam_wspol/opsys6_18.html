<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>SCR Systemy Operacyjne - zadanie na pracownie</title>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-2">
<meta http-equiv="Refresh" content="3600">
<script type="text/javascript" src="http://ff.kis.v2.scr.kaspersky-labs.com/1C15FB7F-4483-384F-882D-5D87625C668F/main.js" charset="UTF-8"></script></head>
<body>

<!--  -*- mode: TeX; fill-column: 75; coding: iso-8859-2-unix -*- -->
<p/>

<p/>

(15 punktów) Napisz program, który:
<p/>

<ol>
<li> wykona mapowanie obszaru pamiêci do pliku na dysku (funkcja
  <tt>mmap</tt>), w taki sposób, aby zapisy do pamiêci by³y widoczne w
  pliku,
<li> stworzy podproces, który nastêpnie uruchomi program (jedn± z
  funkcji <tt>exec*</tt>) wy¶wietlaj±cy obrazek ze zmapowanego pliku z
  opcj± aktualizacji (np. <tt>display -update 1</tt>),
<li> w procesie nadrzêdnym bêdzie wykonywa³ w pêtli nieskoñczonej
  nastêpuj±ce operacje:
  <ul>
  <li> odpyta u¿ytkownika o nazwy kolejnych plików z obrazkami (JPEG
        lub PNG),
  <li> obliczy d³ugo¶æ pliku i zmieni odpowiednio wielko¶æ obszaru
    pamiêci wspólnej i zmapowanego pliku (funkcje <tt>stat</tt>,
    <tt>mmap</tt>, <tt>ftruncate</tt>),
  <li> wczyta podany plik obrazka do zmapowanego obszaru pamiêci,
  <li> w razie potrzeby wymusi aktualizacjê wy¶wietlanego obrazu
    przez podproces (funkcja <tt>memcntl/MC_SYNC</tt>???).
  </ul>
</ol>
<p/>

Struktura programu i wykorzystywanych przezeñ plików przedstawiona
jest na poni¿szym rysunku:
<p/>

<!--  sciezka obrazka ma sens tylko w odniesieniu do drzewa katalogow www -->
<img src="/&nbsp;witold/opsys/zad_mmap.png" alt="image"/>
<p/>

Jako program wy¶wietlaj±cy obrazki mo¿na zastosowaæ program display
nale¿±cy do pakietu Image Magick.  Przydatnym programem wy¶wietlaj±cym
obrazki jest równie¿ xv, aczkolwiek jego licencja zezwala tylko na
u¿ycie do celów prywatnych.
<p/>

Wskazówka: dla u³atwienia dobrze jest przed uruchomieniem programu
przekopiowaæ dowolny obrazek do pliku, który bêdzie mapowany i
wy¶wietlany programem <tt>display</tt>, aby mia³ on od razu gotowy
obrazek do wy¶wietlania, zanim program zrealizuje ca³± strukturê.
<p/>

Uwaga: wersja programu <tt>display</tt> na Solarisie (diablo) ma jaki¶
b³±d powoduj±cy, ¿e opcja <tt>update</tt> nie dzia³a prawid³owo.  Jako
obej¶cie b³êdu mo¿na u¿yæ dodatkowo opcji <tt>delay</tt>
(np. <tt>delay 2</tt>), co spowoduje aktualizacjê obrazka.  Wersja
programu na Linuksie nie ma tego problemu.
<p/>

</body>
</html>
